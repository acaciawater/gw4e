{% extends 'base.html' %}
{% block title %}GW4E Dissemination Tool{% endblock %}
{% block script %}
{{ block.super }}
<script src="//unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
<script>
$(function() {
	// initialize the map
	var map = L.map("map",{center:[10,40],zoom:4});
	var osm = L.tileLayer('//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 19,
 		attribution: '&copy; <a href="//www.openstreetmap.org/copyright">OpenStreetMap</a>'
	})
	
	var stamen = L.tileLayer('http://tile.stamen.com/terrain/{z}/{x}/{y}.png', {
	   attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',
	})
	stamen.addTo(map)
	
	$.getJSON('/static/clusters.json').then(data => {
		const clusters = L.geoJSON(data,{
            onEachFeature: (feature, layer) => {
                layer.bindTooltip(feature.properties.zonename)
                layer.setStyle({color: '#1CABE3'})
                layer.on('mouseover', () => {
                  layer.setStyle({ color: 'red'})
                  layer.bringToFront()
                })
                layer.on('mouseout', () => {
                  layer.setStyle({color:'#1CABE3'})
                })
                layer.on('click', () => {
                	window.open(`/map?cluster=${feature.properties.cluster}`)
                })
              }
		})
		clusters.addTo(map)
		map.fitBounds(clusters.getBounds())
	})
})

</script>
{% endblock %}
{% block style %}
{{ block.super }}
<link rel="stylesheet" href="//unpkg.com/leaflet@1.4.0/dist/leaflet.css"/>

<style>

#map {
  height: 480px;
  border: 1px solid #1CABE3;
}

.container {
  height: 100%;
  background-color: white;
  background-image: url("/static/wave.png");
  background-position: bottom;
  background-size: 100% 15%;
  background-repeat: no-repeat;
}

.note {
  color: white;
  position: absolute;
  top: 90%;
  width: 50%;
  left: 25%;
  font-size: small;
}

.content {
  margin-left: 10%;
  margin-right: 10%;
  padding-top: 24px;
}

h2 {
  padding-bottom: 0.5em;
}

.btn-primary.custom {
  background-color: navy;
  border-color: navy;
}

</style>
{% endblock %}
{% block content %}
<div class="container">
<div class="content">
<h2 class="text-center">Groundwater Mapping<br>for Climate Resilient WASH in Ethiopia</h2>	
<h3 class="text-center">Dissemination of project results</h3>
<hr/>
<div class="row">
<div class="col">
<div id="map" class="mb-2"></div>
<span class="text-muted"><small><i>Click on a cluster to open the map viewer, or preview a (non-validated) country-wide suitability map <a href="/map?cluster=0">here.</a></i>
<a class="btn btn-primary custom float-right" role="button" href="/browse" target="_blank">Documents</a>
</small>
</span>
</div>
</div>
</div>
<div class="note">
<p>The Groundwater Mapping for Climate Resilient WASH in Ethiopia partnership - GW4E has
been carried out by Acacia Water in cooperation with Dr. Seifu
Kebede, Mr. Abebe Ketema, Acquacon Engineering, Ministry of Water, Irrigation and Energy
- MOWIE, EU-JRC and the full leadership and support of UNICEF Ethiopia.
The project has been funded by the EU-RESET II program and has been carried out between June 2018 and
December 2019.</p>
<small class="float-right">1 April 2020</small>
</div>
</div>
{% endblock content %}
